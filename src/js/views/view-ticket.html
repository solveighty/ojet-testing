<!-- ðŸŽ¯ VIEW TICKET - Vista para visualizar detalles del ticket -->
<!-- ============================================================= -->

<div class="oj-flex oj-sm-padding-4x oj-sm-flex-direction-column">
  
  <!-- ðŸŽ¯ TICKET STATUS, RATING AND BUTTONS -->
  <div class="oj-flex-bar oj-sm-padding-2x-bottom oj-sm-align-items-center">
    <div class="oj-flex-bar-middle">
      <span class="oj-text-sm" data-bind="text: ticketStatus(status())"></span>
    </div>
    <div class="oj-flex-bar-end">
      <oj-button class="oj-sm-margin-1x-end" chroming="outlined">Reply</oj-button>
      <oj-button class="oj-sm-margin-1x-end" chroming="outlined">Escalate Priority</oj-button>
      <oj-button chroming="outlined">Close Ticket</oj-button>
    </div>
  </div>
  <!-- ðŸŽ¯ TICKET STATUS, RATING AND BUTTONS -->

  <!-- ðŸŽ¯ TICKET HEADER INFORMATION -->
  <div class="oj-flex oj-sm-padding-4x-vertical">
    <div class="oj-sm-1 oj-sm-padding-3x-top">
      <oj-avatar role="img" aria-label="Author Avatar" size="xs">
      </oj-avatar>
    </div>
    <div class="oj-sm-8 oj-sm-flex-direction-column">
      <h2 data-bind="text: title"></h2>
      <div data-bind="text: author"></div>
    </div>
    <div class="oj-sm-2 oj-text-sm oj-sm-padding-2x-vertical">
      <div data-bind="text: dateDifference(dateCreated())" :title="[[formatDate(dateCreated())]]">
      </div>
    </div>
    <div class="oj-sm-1"></div>
  </div>
  <!-- ðŸŽ¯ TICKET HEADER INFORMATION -->

  <!-- ðŸŽ¯ TICKET MESSAGE -->
  <div class="oj-flex oj-sm-padding-2x-vertical">
    <div class="oj-sm-1"></div>
    <div class="oj-sm-9 oj-sm-padding-4x-bottom" data-bind="html: message"></div>
    <div class="oj-sm-2"></div>
  </div>
  <!-- ðŸŽ¯ TICKET MESSAGE -->

  <!-- ðŸŽ¯ TICKET REPLIES - Lista de respuestas del ticket -->
  <oj-list-view
    id="reply-list-view"
    aria-label="ticket reply list"
    class="oj-sm-12"
    data="[[ticketRepliesDataSource]]"
    item.renderer="[[oj.KnockoutTemplateUtils.getRenderer('ticket-replies-template', true)]]">
  </oj-list-view>
  <!-- ðŸŽ¯ TICKET REPLIES -->

  <!-- ðŸŽ¯ TICKET REPLIES TEMPLATE -->
  <script type="text/html" id="ticket-replies-template">
    <li data-bind="attr: {id: $data['id']}">
      <!-- First row of list item, sets up the item header -->
      <div class="oj-flex oj-sm-padding-4x-vertical"
        data-bind="style: { flexDirection: author !== $parent.author() ? 'row-reverse' : '' }">
        <div class="oj-flex-item oj-sm-1 oj-sm-padding-2x-top"
          data-bind="css: author !== $parent.author() ? 'oj-sm-padding-4x-start' : 'oj-sm-padding-4x-end'">
          <oj-avatar
            role="img"
            aria-label="User Avatar"
            size="xs">
          </oj-avatar>
        </div>
        <div class="oj-sm-8 oj-sm-flex-direction-column">
          <h2 data-bind="text: 'RE: ' + $parent.title(), style: { textAlign: author !== $parent.author() ? 'right' : '' }"></h2>
          <div data-bind="text: author, style: { textAlign: author !== $parent.author() ? 'right' : '' }"></div>
        </div>
        <div class="oj-sm-2 oj-text-sm oj-sm-padding-2x-vertical">
          <div data-bind="text: $parent.dateDifference(timestamp)" :title="[[$parent.formatDate(timestamp)]]"></div>
        </div>
        <div class="oj-sm-1"></div>
      </div>
      <!-- Second row in list item, outputs the message content -->
      <div class="oj-flex oj-sm-padding-2x-vertical">
        <div class="oj-sm-1"></div>
        <div class="oj-sm-10 oj-sm-padding-4x-bottom" data-bind="html: note"></div>
        <div class="oj-sm-1"></div>
      </div>
    </li>
  </script>
  <!-- ðŸŽ¯ TICKET REPLIES TEMPLATE -->

  <!-- ðŸŽ¯ REPLY SECTION - SecciÃ³n para responder al ticket -->
  <h3 class="oj-sm-padding-4x">Reply</h3>
  
  <!-- CSS personalizado para Trumbowyg compacto -->
  <style>
    #ticket-reply-area {
      margin: 0 2rem;
    }
    #ticket-reply-area .trumbowyg-box,
    #ticket-reply-area .trumbowyg-editor {
      min-height: 100px !important;
      height: 100px !important;
    }
    #ticket-reply-area .trumbowyg-button-pane {
      min-height: 36px !important;
      height: 36px !important;
    }
  </style>
  
  <div id="ticket-reply-area"></div>
  
  <!-- ðŸŽ¯ FILE PICKER AND REPLY BUTTON - Selector de archivos y botÃ³n de respuesta -->
  <div class="oj-flex-bar oj-sm-padding-4x-vertical">
    <div class="oj-flex-bar-start oj-sm-align-items-center">
      <oj-file-picker class='oj-filepicker-custom oj-sm-padding-2x-end'
        id="fileUpload"
        selectOn='click'
        on-oj-select='[[fileSelectionListener]]'
        accept="[[allowedFileTypes]]"
        selection-mode='single'>
        <oj-button slot='trigger'>
          <span slot='startIcon' class='oj-fwk-icon oj-fwk-icon-arrowbox-n'></span>
          Upload
        </oj-button>
      </oj-file-picker>
      <oj-bind-if test='[[uploadedFile()[0]]]'>
        <oj-bind-text value="[[uploadedFile()[0].name]]"></oj-bind-text>
      </oj-bind-if>
    </div>
    <div class="oj-flex-bar-end">
      <oj-button id='reply-button' on-oj-action='[[ticketReply]]'>Reply</oj-button>
    </div>
  </div>
  <!-- ðŸŽ¯ FILE PICKER AND REPLY BUTTON -->

</div>
